<script id="govuk-script-analytics" type="text/javascript">
  {% if translationStrings %}
  var i18n = {{ translationStrings | safe }}
  {% endif %}

  window.paymentDetails = {
    description: '{{description}}',
    amount: '{{amount}}',
    chargeID: '{{id}}'
  };

  window.Card = {
    allowed:
      {% if cardsAsStrings %}
        {{ cardsAsStrings | safe }},
      {% else %}
      {},
      {% endif %}
    corporate_card_surcharge_amounts:
      {% if corporateCardSurchargeAmountsAsStrings %}
        {{ corporateCardSurchargeAmountsAsStrings | safe }}
      {% else %}
        {
          credit: 0,
          debit: 0,
          prepaidCredit: 0,
          prepaidDebit: 0
        }
      {% endif %}
  };
  window.Charge = {
    email_collection_mode: '{{ gatewayAccount.emailCollectionMode | safe }}',
    collect_billing_address: {{ "true" if service.collectBillingAddress else "false" }}
  }

  {% if isDevelopment %}
  window.stubWebPaymentsUrl = '{{ stubsUrl }}'
  {# ApplePaySession.stubCanMakePaymentsWithActiveCard = true; #}
  {% endif %}

  var mainWrap = document.getElementsByTagName('main')[0]
  document.addEventListener('DOMContentLoaded', function() {
    GOVUK.stopDoubleSubmit.init();
    if (mainWrap.classList.contains('charge-new')) {
      formValidation();
      showCardType().init();
      window.payScripts.inputConfirm.init();
    } else if (mainWrap.classList.contains('confirm-page')) {
      analyticsTrackConfirmClick().init('{{analytics.analyticsId}}', '{{analytics.type}}', '{{analytics.paymentProvider}}', '{{analytics.amount}}', '{{hitPage}}');
    }
    {% if allowGooglePay and googlePayGatewayMerchantID%}
      window.googlePayGatewayMerchantID = '{{ googlePayGatewayMerchantID }}';
      window.googlePayMerchantID = '{{ googlePayMerchantID }}';
    {% endif %}
    {% if allowApplePay and allowGooglePay and googlePayGatewayMerchantID%}
      window.payScripts.webPayments.init('all');
    {% elif allowApplePay %}
      window.payScripts.webPayments.init('apple');
    {% elif allowGooglePay and googlePayGatewayMerchantID %}
      window.payScripts.webPayments.init('google');
    {% endif %}
  });
</script>
{% if isDevelopment %}
{# <script src="public/javascripts/apple-pay-js-stubs.js"></script> #}
{% endif %}
<script src="{{ js_path }}"></script>
